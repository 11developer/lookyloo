{% if from_popup %}
{% extends "main.html" %}

{% from 'bootstrap5/utils.html' import render_messages %}

{% block title %}{{ body_hash }}{% endblock %}

{% block scripts %}
{{ super() }}
<script type="text/javascript">
    $('#table').DataTable( {
        "order": [[ 1, "desc" ]],
        "pageLength": 500
    });
</script>

<script type="text/javascript">
    function openTreeInNewTab(treeUUID) {
        window.opener.openTreeInNewTab(treeUUID);
    };
</script>

{% endblock %}
{%endif%}

{% block content %}

{% if from_popup %}
<button onclick="window.history.back();" class="btn btn-primary" type="button">Go Back</button>
{%endif%}

<script type="text/javascript">
  new DataTable('#bodyHashDetailsTable', {
    columnDefs: [{ width: '20%', targets: 0 },
                 { width: '80%', targets: 1 }],
  });
</script>
<center>
    <h4>{{ body_hash }}</h4>
</center>
<table id="bodyHashDetailsTable" class="table table-striped" style="width:100%">
  <thead>
   <tr>
     <th>Hostname</th>
     <th>Frequency</th>
   </tr>
  </thead>
  <tbody>
    {% for domain, freq in domains %}
    <tr>
      <td>
        {{ domain }}
      </td>
      <td>{{ freq }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
</div>
<p>The same file was seen in these captures:</p>
<ul>
{% for capture_uuid, title in captures %}
  <li>
    {% if from_popup %}
    <a href="#/" onclick="openTreeInNewTab('{{ capture_uuid }}')">{{ title }}</a>
    {% else %}
    <a href="{{ url_for('tree', tree_uuid=capture_uuid) }}">{{ title }}</a>
    {% endif %}
  </li>
{% endfor %}
</ul>
{% endblock %}
