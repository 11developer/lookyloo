{% extends "main.html" %}

{% block title %}Statistics{% endblock %}

{% block content %}
<div>
{% for weeks in stats['weeks'] %}
  <h2> Week: {{ weeks['week'] }}</h2>
  <div class="table-responsive">
  <table id="table" class="table" style="width:96%">
    <thead>
    <tr>
      <th>Submissions</th>
      <th>Submissions with redirects</th>
      <th>Redirects</th>
      <th>Unique urls (including redirects)</th>
      <th>Unique domains (including redirects)</th>
    </tr>
    </thead>
    <tbody>
    <tr>
      <td> {{ weeks['analysis'] }} </td>
      <td> {{ weeks['analysis_with_redirects'] }} </td>
      <td> {{ weeks['redirects'] }} </td>
      <td> {{ weeks['uniq_urls'] }} </td>
      <td> {{ weeks['uniq_domains'] }} </td>
    </tr>
    </tbody>
  </table>
  </div>
{% endfor %}
</div>

<div>
{% for name, dict_ in stats['years'].items() %}
  <h2>Year: {{ name }}</h2>
  <ul>
      <li><b>Total analysis</b>: {{ dict_['yearly_analysis'] }}</li>
      <li><b>Total redirects</b>: {{ dict_['yearly_redirects'] }}</li>
  </ul>
  <div>
      {% for monthnumber, month in dict_.items() %}
      {% if monthnumber is number %}
      <h4>{{ month_name(monthnumber) }}</h4>
      <div class="table-responsive">
      <table id="table" class="table" style="width:96%">
        <thead>
        <tr>
          <th>Submissions</th>
          <th>Submissions with redirects</th>
          <th>Redirects</th>
          <th>Unique urls (including redirects)</th>
          <th>Unique domains (including redirects)</th>
        </tr>
        </thead>
        <tbody>
          <tr>
            <td> {{ month['analysis'] }} </td>
            <td> {{ month['analysis_with_redirects'] }} </td>
            <td> {{ month['redirects'] }} </td>
            <td> {{ month['uniq_urls'] }} </td>
            <td> {{ month['uniq_domains'] }} </td>
          </tr>
        </tbody>
      </table>
      </div>
      {% endif %}
      {% endfor %}
  </div>
{% endfor %}
</div>

<div class='graphs'></div>
{% endblock %}

{% block scripts %}
{{ super() }}
<script src='{{ url_for('static', filename='d3.v6.min.js') }}'></script>
<script src='{{ url_for('static', filename='stats_graph.js') }}'></script>
{% endblock %}

{% block styles %}
{{ super() }}
<link rel="stylesheet" href="{{ url_for('static', filename='stats.css') }}">
{% endblock %}
